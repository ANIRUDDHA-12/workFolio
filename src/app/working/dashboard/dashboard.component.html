<div class="faculty-tracker">
  <div class="back-button-container">
    <button class="back-button" (click)="goBack()">
      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M19 12H5"></path>
        <path d="M12 19l-7-7 7-7"></path>
      </svg>
      Back
    </button>
  </div>

  <!-- Header Section -->
  <header class="header">
    <div class="header-content">
      <div class="header-left">
        <div class="graduation-cap-icon">
          <svg width="40" height="40" viewBox="0 0 24 24" fill="none">
            <path d="M12 3L1 9L12 15L21 9V16H23V9L12 3Z" fill="white"/>
            <path d="M5 13.18V17.18C5 17.97 5.63 18.74 6.4 19.09C8.61 20.15 10.26 20.73 12 20.73C13.74 20.73 15.39 20.15 17.6 19.09C18.37 18.74 19 17.97 19 17.18V13.18L12 17L5 13.18Z" fill="white"/>
          </svg>
        </div>
        <div class="header-text">
          <h1>Welcome, {{ userName }}</h1>
          <p>Track your academic activities and monitor workload efficiently</p>
        </div>
      </div>
      <div class="header-right">
        <div class="user-profile">
          <div class="user-avatar" *ngIf="userProfileImage" [style.backgroundImage]="'url(' + userProfileImage + ')'"></div>
          <div class="user-avatar" *ngIf="!userProfileImage">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
              <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              <circle cx="12" cy="7" r="4" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </div>
          <span class="user-name">Welcome, {{ userName }}</span>
          <button class="logout-btn" (click)="logout()">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
              <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              <path d="M16 17l5-5-5-5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              <path d="M21 12H9" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
            Logout
          </button>
        </div>
      </div>
    </div>
  </header>

  <!-- Navigation -->
  <nav class="navigation">
    <div class="nav-item" routerLink="/dashboard" routerLinkActive="active" (click)="navigateToTab('dashboard')">
      <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
        <rect x="3" y="3" width="7" height="7" stroke="currentColor" stroke-width="2" fill="currentColor"/>
        <rect x="14" y="3" width="7" height="7" stroke="currentColor" stroke-width="2" fill="currentColor"/>
        <rect x="14" y="14" width="7" height="7" stroke="currentColor" stroke-width="2" fill="currentColor"/>
        <rect x="3" y="14" width="7" height="7" stroke="currentColor" stroke-width="2" fill="currentColor"/>
      </svg>
      Dashboard
    </div>
    <div class="nav-item" routerLink="/log-task" routerLinkActive="active" (click)="navigateToTab('log-task')">
      <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" stroke="currentColor" stroke-width="2"/>
        <polyline points="14,2 14,8 20,8" stroke="currentColor" stroke-width="2"/>
        <line x1="16" y1="13" x2="8" y2="13" stroke="currentColor" stroke-width="2"/>
        <line x1="16" y1="17" x2="8" y2="17" stroke="currentColor" stroke-width="2"/>
        <polyline points="10,9 9,9 8,9" stroke="currentColor" stroke-width="2"/>
      </svg>
      Log Task
    </div>
    <div class="nav-item" routerLink="/analytics" routerLinkActive="active" (click)="navigateToTab('analytics')">
      <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
        <polyline points="22,12 18,12 15,21 9,3 6,12 2,12" stroke="currentColor" stroke-width="2"/>
      </svg>
      Analytics
    </div>
  </nav>

  <!-- Stats Section -->
  <div class="stats-container">
    <div class="stat-card">
      <h3>Total Tasks</h3>
      <div class="stat-value">{{ totalTasks }}</div>
    </div>
    <div class="stat-card">
      <h3>Total Hours</h3>
      <div class="stat-value">{{ totalHours.toFixed(1) }}h</div>
    </div>
    <div class="stat-card">
      <h3>Active Subjects</h3>
      <div class="stat-value">{{ activeSubjects }}</div>
    </div>
    <div class="stat-card">
      <h3>Generate Report</h3>
      <button class="pdf-btn" (click)="generateWeeklyReport()" [disabled]="isGeneratingPDF">
        <svg *ngIf="!isGeneratingPDF" width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
          <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8l-6-6z"/>
          <polyline points="14 2 14 8 20 8"/>
          <line x1="16" y1="13" x2="8" y2="13"/>
          <line x1="16" y1="17" x2="8" y2="17"/>
          <polyline points="10 9 9 9 8 9"/>
        </svg>
        <div *ngIf="isGeneratingPDF" class="loading-spinner"></div>
        {{ isGeneratingPDF ? 'Generating...' : 'Generate PDF' }}
      </button>
    </div>
  </div>

  <!-- Recent Tasks Section -->
  <div class="recent-tasks-section">
    <div class="section-header">
      <h2>Recent Tasks</h2>
      <div class="task-header-actions">
        <span class="task-count">{{ recentTasks.length }} of {{ totalTasks }} tasks</span>
        <div class="share-buttons">
          <!-- WhatsApp Share -->
          <button class="share-btn whatsapp" (click)="shareViaWhatsApp()" title="Share via WhatsApp" [disabled]="isSharing">
            <svg *ngIf="!isSharing" width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
              <!-- WhatsApp SVG -->
              <path d="M17.472 14.382...z"/> <!-- Use full path here -->
            </svg>
            <div *ngIf="isSharing" class="loading-spinner"></div>
            <span>{{ isSharing ? 'Preparing...' : 'Share via WhatsApp' }}</span>
          </button>

          <!-- Email Share -->
          <button class="share-btn email" (click)="shareViaEmail()" title="Share via Email" [disabled]="isSharing">
            <svg *ngIf="!isSharing" width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
              <path d="M20 4H4c-1.1 0-1.99...z"/>
            </svg>
            <div *ngIf="isSharing" class="loading-spinner"></div>
            <span>{{ isSharing ? 'Preparing...' : 'Share via Email' }}</span>
          </button>
        </div>
      </div>
    </div>

    <div class="empty-state" *ngIf="recentTasks.length === 0">
      <div class="graduation-cap-icon-large">
        <svg width="80" height="80" viewBox="0 0 24 24" fill="none">
          <path d="M12 3L1 9L12 15L21 9V16H23V9L12 3Z" fill="#9ca3af"/>
          <path d="M5 13.18V17.18C5 17.97...z"/>
        </svg>
      </div>
      <h3>No tasks logged yet</h3>
      <p>Start by logging your first academic activity</p>
      <button class="log-task-btn" (click)="logFirstTask()">Log Your First Task</button>
    </div>

    <div class="task-list" *ngIf="recentTasks.length > 0">
      <div class="task-item" *ngFor="let task of recentTasks">
        <div class="task-header">
          <h3 class="task-subject">{{ task.subject }}</h3>
          <span class="task-type" [ngClass]="task.workType.toLowerCase()">{{ task.workType }}</span>
        </div>
        <div class="task-details">
          <div class="task-date">{{ task.date | date: 'mediumDate' }}</div>
          <div class="task-hours">{{ task.hours }}h</div>
        </div>
        <p class="task-description" *ngIf="task.description">{{ task.description }}</p>
      </div>

      <button class="view-all-btn" (click)="navigateToTab('log-task')">View All Tasks</button>
    </div>
  </div>
</div>
